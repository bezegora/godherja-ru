@designate_heir_cost = 1000
@designate_heir_cost_discounted = 100

designate_heir_h_o_interaction = {

	category = interaction_category_diplomacy

	desc = designate_heir_interaction_desc

	is_shown = {
		bilateral_ruin_diplomatic_block = yes
		scope:recipient = {
			is_adult = yes
		}
		scope:actor.faith = scope:recipient.faith
		scope:actor.dynasty = scope:recipient.dynasty
		NOT = {
			scope:recipient = scope:actor.designated_heir
		}
		scope:actor = {
			has_government = landed_order_government
		}
	}

	is_valid_showing_failures_only = {
		scope:recipient = { is_diplomatically_available = yes }
		trigger_if = {
			limit = { scope:actor = { has_realm_law = aversarian_succession_law } }
			scope:actor = { prestige >= @designate_heir_cost_discounted }
		}
		trigger_else = {
			scope:actor = { prestige >= @designate_heir_cost }
		}
	}

	on_auto_accept = {
		scope:recipient = {
			trigger_event = char_interaction.0120
		}
	}

	on_accept = {
		scope:actor = {
			send_interface_toast = {
				title = designate_heir_interaction_notification

				left_icon = scope:actor					
				right_icon = scope:recipient

				set_designated_heir = scope:recipient
				if = {
					limit = { scope:actor = { has_realm_law = aversarian_succession_law } }
					add_prestige = { subtract = @designate_heir_cost_discounted }
				}
				else = {
					add_prestige = { subtract = @designate_heir_cost }
				}
			}
		}
	}

	auto_accept = yes
}

adopt_heir_interaction = {

	category = interaction_category_diplomacy

	desc = adopt_interaction_desc

	is_shown = {
		bilateral_ruin_diplomatic_block = yes
		
		scope:recipient = {
			is_adult = yes
		}
		scope:actor.faith = scope:recipient.faith
		NOR = {
			scope:actor.dynasty = scope:recipient.dynasty
			scope:actor = {
				is_at_war_with = scope:recipient
			}
			any_close_family_member = {
				this = scope:recipient
			}
			any_spouse = {
				this = scope:recipient
			}
		}
		scope:actor = {
			has_government = landed_order_government
			age > 40
		}
		scope:recipient = {
			is_diplomatically_available = yes
			is_imprisoned = no
		}
	}

	is_valid_showing_failures_only = {
		scope:recipient = { is_diplomatically_available = yes }
		custom_description = {
			scope:recipient = {
				age < scope:actor.age
			}
			text = recipient_must_be_younger_to_adopt
		}
		trigger_if = {
			limit = { scope:actor = { has_realm_law = aversarian_succession_law } }
			scope:actor = { prestige >= @designate_heir_cost_discounted }
		}
		trigger_else = {
			scope:actor = { prestige >= @designate_heir_cost }
		}
	}

	on_auto_accept = {
		scope:recipient = {
			set_house = scope:actor.house
		}
	} 

	on_accept = {
		scope:actor = {
			send_interface_toast = {
				title = designate_heir_interaction_notification
				left_icon = scope:actor					
				right_icon = scope:recipient
				scope:recipient = {
					set_house = scope:actor.house
					if = {
						limit = { scope:actor = { is_female = yes } }
						custom_description = {
							set_mother = scope:actor
							text = becomes_mother_of_effect
							subject = scope:actor
							object = this
						}
					}
					else = {
						custom_description = {
							set_father = scope:actor
							text = becomes_father_of_effect
							subject = scope:actor
							object = this
						}
					}
				}
				
				if = {
					limit = { scope:actor = { has_realm_law = aversarian_succession_law } }
					add_prestige = { subtract = @designate_heir_cost_discounted }
				}
				else = {
					add_prestige = { subtract = @designate_heir_cost }
				}
			}
		}
	}

	auto_accept = yes
}
