secret_tahariat_evader = {
	category = religious

	is_valid = {
		NOT = {
			scope:secret_owner = {
				has_character_flag = recently_paid_tahariat
			}
		}
	}

	is_shunned = {
		OR = {
			scope:secret_target.faith = {
				has_doctrine = tenet_tax_nonbelievers
			}
			scope:secret_owner.liege.faith = {
				has_doctrine = tenet_tax_nonbelievers
			}
			scope:secret_owner.top_liege.faith = {
				has_doctrine = tenet_tax_nonbelievers
			}
		}
		NOT = {
			scope:secret_target.faith = scope:secret_owner.faith
		}
	}

	is_criminal = {
		OR = {
			scope:secret_target.faith = {
				has_doctrine = tenet_tax_nonbelievers
			}
			scope:secret_owner.liege.faith = {
				has_doctrine = tenet_tax_nonbelievers
			}
			scope:secret_owner.top_liege.faith = {
				has_doctrine = tenet_tax_nonbelievers
			}
		}
		NOT = {
			scope:secret_target.faith = scope:secret_owner.faith
		}
	}

	on_expose = {
		save_scope_as = secret
		scope:secret_owner = {
			if = {
				limit = {
					NOT = {
						this = scope:secret_exposer
					}
				}
				trigger_event = gh_sarradon_secrets.0001
			}
		}
		secret_exposed_notification_effect = yes
	}
}