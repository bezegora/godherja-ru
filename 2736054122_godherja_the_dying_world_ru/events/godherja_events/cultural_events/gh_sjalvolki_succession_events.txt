namespace = sjalvolki_succession

##################################################

### Sjalvolki Succession Events

# 0001 - Introduction and Invitations

##################################################

scripted_trigger valid_for_sjalvolki_succession_trigger = {
	is_alive = yes
	is_incapable = no
	is_imprisoned = no
	NOR = {
		has_trait = blind
		has_trait = gh_dehanded
		has_title = title:e_sjalvolki
	}
	trigger_if = {
		limit = { is_adult = no }
		age >= 14
		OR = {
			has_trait = brave
			has_trait = ambitious
			has_trait = physique_good_2
			has_trait = physique_good_3
			has_trait = giant
		}
	}
}

##################################################
# Introduction and Invitations
# by mpjama and Hapchazzard
# 0001 - 0010
##################################################

sjalvolki_succession.0001 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0001.t
	desc = sjalvolki_succession.0001.desc
	
	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = craven
					ai_boldness <= -100
				}
			}
			animation = personality_coward
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = brave
					ai_boldness >= -100
				}
			}
			animation = personality_bold
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = callous
					has_trait = sadistic
					NOR = {
						has_trait = brave
						has_trait = craven
						ai_boldness <= -100
						ai_boldness >= -100
					}
				}
			}
			animation = personality_callous
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = worry
		}
	}
	
	override_background = {
		trigger = { has_government = tribal_government }
		event_background = fp1_throneroom_tribal
	}
	override_background = {
		trigger = { NOT = { has_government = tribal_government } }
		event_background = fp1_throneroom_nontribal
	}
	
	immediate = {
		scope:title = {
			save_scope_as = primary_scope
			setup_succession_titles = yes
		}
		save_scope_as = temporary_title_holder
	}
	
	# Accept
	option = {
		name = sjalvolki_succession.0001.a
		add_internal_flag = dangerous
		custom_tooltip = will_join_sjalvolki_succession_tt
		name = {
			trigger = { has_trait = brave }
			text = sjalvolki_succession.0001.a.brave
		}
		name = {
			trigger = { has_trait = callous }
			text = sjalvolki_succession.0001.a.callous
		}
		name = {
			trigger = { has_trait = sadistic }
			text = sjalvolki_succession.0001.a.sadistic
		}
		name = {
			trigger = { has_trait = zealous }
			text = sjalvolki_succession.0001.a.zealous
		}
		name = {
			text = sjalvolki_succession.0001.a
		}
		
		scope:primary_scope = {
			add_to_variable_list = {
				name = contesting_linked_titles
				target = root
			}
		}
		stress_impact = {
			craven = medium_stress_impact_gain	# Cowards gain stress for obvious reasons
			content = medium_stress_impact_gain	# As do content characters
			paranoid = medium_stress_impact_gain # Paranoid characters are going to fret that they might die. It's intentional that they receive stress in both cases.
			zealous = minor_stress_impact_loss	# Zealous characters will be glad to participate in such a hallowed tradition
			ambitious = minor_stress_impact_loss	# Ambitious characters will be thinking of the potential rewards
		}
		ai_chance = {
			base = 50	# AI is heavily skewed towards defending their birthright
			ai_value_modifier = {
				ai_energy = 0.5
				ai_boldness = 0.25
				ai_zeal = 0.25
			}
			modifier = {	# If they can barely hold a sword, they should seriously contemplate how wise this is
				add = -40
				prowess < 1
			}
			modifier = {	# Being mediocre should also make them reconsider, unless their vassals all also have godawful prowess
				add = -10
				prowess < 5
				NOT = {
					any_vassal = {
						prowess >= 10
					}
				}
			}
			modifier = {	# Being pretty good will significantly up their odds
				add = 10
				prowess >= 20
			}
			modifier = {	# As will being extremely good
				add = 10
				prowess >= 30
			}
			modifier = {	# Ambitious people are even more likely to fight
				factor = 2
				has_trait = ambitious
			}
		}
	}
	# Extremely dishonorable rulers can outright not hold one
	option = {
		name = sjalvolki_succession.0001.b
		trait = callous
		trait = sadistic
		trait = arbitrary
		trait = deceitful
		add_internal_flag = dangerous
		custom_tooltip = no_sjalvolki_succession_tt
		trigger = {
			OR = { # Must be especially vile or tyrannically-bent to even consider this
				has_trait = sadistic
				has_trait = callous
			}
			OR = { # And also must have a profoundly dishonorable personality
				has_trait = arbitrary
				has_trait = deceitful
			}
		}
		add_tyranny = high_tyranny
		add_prestige = major_prestige_loss
		add_piety = monumental_piety_loss
		add_piety_level = -1
		every_vassal = {
			limit = {
				highest_held_title_tier >= tier_county
			}
			add_pressed_claim = scope:primary_scope
		}
		
		save_scope_value_as = {
			name = blocked_sjalvolki_succession
			value = yes
		}
		stress_impact = {
			just = major_stress_gain	# Just characters are obviously really not going to dig doing this
			zealous = major_stress_gain	# Zealous characters are also going to not like basically spitting in Velos' face
			craven = minor_stress_loss	# Craven characters will be happy to at least not have to fight
			cynical = minor_stress_impact_loss # Cynical characters don't give a toss about these traditions anyway
		}
		ai_chance = {
			base = 10	# If AI gets this, they will... contemplate it, but it should not be common to see actually happen
			ai_value_modifier = {
				ai_honor = -0.25
				ai_zeal = -0.25
				ai_greed = 0.25
			}
			modifier = {	# If they can barely hold a sword, it might be worth doing this
				add = 20
				prowess < 1
			}
			modifier = {	# Being mediocre should also make them consider, unless their vassals all also have godawful prowess
				add = 10
				prowess < 5
				NOT = {
					any_vassal = {
						prowess >= 10
					}
				}
			}
			modifier = {	# If they're good anyway, eh, it's not worth it most likely when they can just win
				add = -20
				prowess >= 20
			}
			modifier = {	# If they're REALLY good, it's almost surely not worth it to do this
				add = -30
				prowess >= 30
			}
			modifier = {	# Zealous and just characters will absolutely never do this
				factor = 0
				OR = {
					has_trait = zealous
					has_trait = just
				}
			}
		}
	}
	# Don't participate
	option = {
		name = sjalvolki_succession.0001.c
		
		stress_impact = {
			brave = medium_stress_impact_gain
			ambitious = medium_stress_impact_gain
			paranoid = medium_stress_impact_gain
			cynical = minor_stress_impact_loss
			content = minor_stress_impact_loss
		}
		ai_chance = {
			base = 10	# AI is unlikely to just give up their birthright without a fight
			ai_value_modifier = {
				ai_energy = -0.5
				ai_boldness = -0.25
				ai_zeal = -0.25
			}
			modifier = {
				add = 25
				prowess < 1
			}
			modifier = {
				add = 10
				prowess < 5
				NOT = {
					any_vassal = {
						prowess >= 10
					}
				}
			}
			modifier = {
				add = -10
				prowess >= 20
			}
			modifier = {
				add = -15
				prowess >= 30
			}
			modifier = {	# Content people are even less likely to fight
				factor = 2
				has_trait = content
			}
		}
	}
	
	after = {
		if = {
			limit = { NOT = { exists = scope:blocked_sjalvolki_succession }}
			every_vassal = {
				limit = {
					primary_title.tier >= tier_county
					has_culture_group = culture_group:gh_sjalvolki_group
					has_religion = religion:sjalvolki_religion
					valid_for_sjalvolki_succession_trigger = yes
				}
				trigger_event = {
					id = sjalvolki_succession.0002
					days = 1
				}
			}
			#also add the valid dynasty members here later...
			root.dynasty = {
				every_dynasty_member = {
					limit = { 
						age >= 16
						NOT = {
							top_liege = root
						}
						NOT = {
							is_imprisoned = yes
						}
						OR = {
							NOT = { is_liege_or_above_of = root }
							has_claim_on = scope:primary_scope
						}
					}
					trigger_event = {
						id = sjalvolki_succession.0003
						days = 1
					}
				}
			}
			trigger_event = {
				id = sjalvolki_succession.0051
				weeks = 1
			}
		}
	}
}

# Invitation to a vassal
sjalvolki_succession.0002 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0002.t
	desc = sjalvolki_succession.0002.desc
	
	override_background = {
		trigger = { has_government = tribal_government }
		event_background = fp1_throneroom_tribal
	}
	override_background = {
		trigger = { NOT = { has_government = tribal_government } }
		event_background = fp1_throneroom_nontribal
	}
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	right_portrait = {
		character = scope:temporary_title_holder
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = craven
					ai_boldness <= -100
				}
			}
			animation = personality_coward
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = brave
					ai_boldness >= -100
				}
			}
			animation = personality_bold
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = callous
					has_trait = sadistic
					NOR = {
						has_trait = brave
						has_trait = craven
						ai_boldness <= -100
						ai_boldness >= -100
					}
				}
			}
			animation = personality_callous
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = worry
		}
	}
	
	# Participate
	option = {
		name = sjalvolki_succession.0002.a
		scope:primary_scope={
			add_to_variable_list = {
				name = contesting_linked_titles
				target = root
			}
		}
		stress_impact = {
			craven = medium_stress_impact_gain
			content = medium_stress_impact_gain
		}
		ai_chance = {
			base = 50	# AI is 50/50 by default on whether to participate
			ai_value_modifier = {
				ai_energy = 0.5
				ai_boldness = 0.25
				ai_zeal = 0.25
			}
			modifier = {	# If they can barely hold a sword, they should seriously contemplate how wise this is
				add = -40
				prowess < 1
			}
			modifier = {	# Being mediocre should also make them reconsider, unless their vassals all also have godawful prowess
				add = -15
				prowess < 5
				NOT = {
					scope:temporary_title_holder = {
						any_vassal = {
							prowess >= 10
						}
					}
				}
			}
			modifier = {	# Being pretty good will significantly up their odds
				add = 10
				prowess >= 20
			}
			modifier = {	# As will being extremely good
				add = 30
				prowess >= 30
			}
			modifier = {	# Ambitious people are even more likely to fight
				factor = 2
				has_trait = ambitious
			}
			modifier = {	# Content people will never bother participating
				factor = 0
				has_trait = content
			}
		}
	}
	# Don't Participate
	option = {
		name = sjalvolki_succession.0002.b
		stress_impact = {
			brave = medium_stress_impact_gain
			ambitious = medium_stress_impact_gain
		}
		ai_chance = {
			base = 50	# AI is 50/50 by default on whether to participate
			ai_value_modifier = {
				ai_energy = -0.5
				ai_boldness = -0.25
				ai_zeal = -0.25
			}
			modifier = {
				add = 20
				prowess < 1
			}
			modifier = {
				add = 10
				prowess < 5
				NOT = {
					scope:temporary_title_holder = {
						prowess >= 10
					}
				}
			}
			modifier = {
				add = -10
				prowess >= 20
			}
			modifier = {
				add = -20
				prowess >= 30
			}
			modifier = {	# Content people will never bother participating
				add = 1000
				has_trait = content
			}
		}
	}
	
}

#introduction to sjalvolki_succession, valid contestant by blood
sjalvolki_succession.0003 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0003.t
	desc = sjalvolki_succession.0003.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = root
		animation = rage
	}
	
	#yes
	option = {
		name = sjalvolki_succession.0003.a
		scope:primary_scope={
			add_to_variable_list = {
				name = contesting_linked_titles
				target = root
			}
		}
		stress_impact = {
			craven = medium_stress_impact_gain
			content = medium_stress_impact_gain
		}
	}
	option = {
		name = sjalvolki_succession.0002.b
		stress_impact = {
			brave = medium_stress_impact_gain
			ambitious = medium_stress_impact_gain
		}
	}
}

# First Ring Introduction
sjalvolki_succession.0004 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0004.t
	desc = sjalvolki_succession.0004.desc
	
	override_background = {
		event_background = fp1_tribal_temple
	}
	
	immediate = {
		scope:primary_scope = {
			random_in_list = {
				variable = contesting_linked_titles_first_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_1
			}
			
			random_in_list = {
				variable = contesting_linked_titles_first_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_2
			}
		
		}
	}
	
	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = craven
					ai_boldness <= -100
				}
			}
			animation = personality_coward
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = brave
					ai_boldness >= -100
				}
			}
			animation = personality_bold
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = callous
					has_trait = sadistic
					NOR = {
						has_trait = brave
						has_trait = craven
						ai_boldness <= -100
						ai_boldness >= -100
					}
				}
			}
			animation = personality_callous
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = worry
		}
	}
	option = {
		name = sjalvolki_succession.0004.a
	}
}

# Second Ring Introduction
sjalvolki_succession.0005 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0005.t
	desc = sjalvolki_succession.0005.desc
	
	override_background = {
		event_background = fp1_tribal_temple
	}
	
	immediate = {
		scope:primary_scope = {
			random_in_list = {
				variable = contesting_linked_titles_second_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_1
			}
			
			random_in_list = {
				variable = contesting_linked_titles_second_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_2
			}
		
		}
	}
	
	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = craven
					ai_boldness <= -100
				}
			}
			animation = personality_coward
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = brave
					ai_boldness >= -100
				}
			}
			animation = personality_bold
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = callous
					has_trait = sadistic
					NOR = {
						has_trait = brave
						has_trait = craven
						ai_boldness <= -100
						ai_boldness >= -100
					}
				}
			}
			animation = personality_callous
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = worry
		}
	}
	option = {
		name = sjalvolki_succession.0005.a
	}
}

# Third Ring Introduction
sjalvolki_succession.0006 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0006.t
	desc = sjalvolki_succession.0006.desc
	
	override_background = {
		event_background = fp1_tribal_temple
	}
	
	immediate = {
		scope:primary_scope = {
			random_in_list = {
				variable = contesting_linked_titles_third_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_1
			}
			
			random_in_list = {
				variable = contesting_linked_titles_third_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_2
			}
		
		}
	}
	
	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = craven
					ai_boldness <= -100
				}
			}
			animation = personality_coward
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = brave
					ai_boldness >= -100
				}
			}
			animation = personality_bold
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = callous
					has_trait = sadistic
					NOR = {
						has_trait = brave
						has_trait = craven
						ai_boldness <= -100
						ai_boldness >= -100
					}
				}
			}
			animation = personality_callous
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = worry
		}
	}
	option = {
		name = sjalvolki_succession.0006.a
	}
}

# Fourth Ring Introduction
sjalvolki_succession.0007 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0007.t
	desc = sjalvolki_succession.0007.desc
	
	override_background = {
		event_background = fp1_runestone_circle	# Fourth ring is outdoors
	}
	
	immediate = {
		scope:primary_scope = {
			random_in_list = {
				variable = contesting_linked_titles_fourth_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_1
			}
			
			random_in_list = {
				variable = contesting_linked_titles_fourth_ring
				limit = {
					NOT = {
						this = root
					}
				}
				save_scope_as = random_2
			}
		
		}
	}
	
	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = craven
					ai_boldness <= -100
				}
			}
			animation = personality_coward
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = brave
					ai_boldness >= -100
				}
			}
			animation = personality_bold
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = callous
					has_trait = sadistic
					NOR = {
						has_trait = brave
						has_trait = craven
						ai_boldness <= -100
						ai_boldness >= -100
					}
				}
			}
			animation = personality_callous
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = worry
		}
	}
	option = {
		name = sjalvolki_succession.0007.a
	}
}

#lost a fight, disqualified!
sjalvolki_succession.0008 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0008.t
	desc = sjalvolki_succession.0008.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = root
		animation = shame
	}
	
	immediate = {
		scope:primary_scope = {
			if = {
				limit = { has_variable_list = contesting_linked_titles_first_ring }
				remove_list_variable = {
					name = contesting_linked_titles_first_ring
					target = root
				}
			}
			if = {
				limit = { has_variable_list = contesting_linked_titles_second_ring }
				remove_list_variable = {
					name = contesting_linked_titles_second_ring
					target = root
				}
			}
			if = {
				limit = { has_variable_list = contesting_linked_titles_third_ring }
				remove_list_variable = {
					name = contesting_linked_titles_third_ring
					target = root
				}
			}
			if = {
				limit = { has_variable_list = contesting_linked_titles_fourth_ring }
				remove_list_variable = {
					name = contesting_linked_titles_fourth_ring
					target = root
				}
			}
			if = {
				limit = { has_variable_list = contesting_linked_titles_fifth_ring }
				remove_list_variable = {
					name = contesting_linked_titles_fifth_ring
					target = root
				}
			}
		}
	}
	
	option = {
		name = sjalvolki_succession.0008.a
		add_prestige = minor_prestige_loss
		add_character_modifier = { #minor health boost for injured characters so they all dont die after being spared
			modifier = survived_dovatkning
			years = 2
		}
	}
}

#won a fight, keep going!
sjalvolki_succession.0009 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0009.t
	desc = sjalvolki_succession.0009.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = root
		animation = war_over_win
	}
	
	right_portrait = {
		character = var:partner
		animation = beg
	}
	
	#spare
	option = {
		name = sjalvolki_succession.0009.a
		var:partner = {
			trigger_event = sjalvolki_succession.0008
		}
		stress_impact = {
			vengeful = medium_stress_impact_gain
			sadistic = medium_stress_impact_gain
		}
		add_prestige = minor_prestige_gain
		ai_chance = {
			base = 50
			ai_value_modifier = {
				ai_sociability = 0.25
			}
			modifier = {	# Character whose content is happy to spare instead of kill
				add = 20
				has_trait = content
			}
			modifier = {	# Character would rather kill the losers then keep them alive
				add = -10
				has_trait = craven
			}
			modifier = {	# Character would rather kill the losers then keep them alive
				add = -25
				has_trait = wrathful
			}
			modifier = {	# Character would rather kill the losers then keep them alive
				add = -50
				has_trait = ambitious
			}
			modifier = {	# Character thinks its too much effort to kill them all
				add = 5
				has_trait = lazy
			}
			modifier = {	# A forgiving character would never kill the person he dueled
				add = 1000
				has_trait = forgiving
			}
			modifier = {	# A just character would probably never kill his competition (although it is fair)
				add = 80
				has_trait = just
			}			
			modifier = {	# Character would rather kill the losers then keep them alive
				add = -50
				has_trait = vengeful
			}
			modifier = {	# A shy character would be more predisposed to spare them, not drawing attention to themselves
				add = 10
				has_trait = shy
			}
			modifier = {	# Character has just as much chance of killing as sparing them
				add = 10
				has_trait = arbitrary
			}
			modifier = {	# Character would be paranoid the loser would hold a grudge and thus better them being dead
				add = -10
				has_trait = paranoid
			}
			modifier = {	# A trusting character would let bygones be bygones
				add = 40
				has_trait = trusting
			}
			modifier = {	# A compassionate character wouldn't kill his foe
				add = 100
				has_trait = compassionate
			}
			modifier = {	# A sadistic character would always kill his competitor
				add = -1000
				has_trait = sadistic
			}
			modifier = {	# A callous character would almost always kill his competitor 
				add = -100
				has_trait = callous
			}																											
		}
	}
	
	#kill!
	option = {
		name = sjalvolki_succession.0009.b
		var:partner = {
			trigger_event = sjalvolki_succession.0010
		}
		stress_impact = {
			just = medium_stress_impact_gain
			compassionate = medium_stress_impact_gain
		}
		add_prestige = minor_prestige_loss
		ai_chance = {
			base = 50
			ai_value_modifier = {
				ai_vengefulness = 0.5
			}
			modifier = {	# A content character wouldn't kill them
				add = -20
				has_trait = content
			}
			modifier = {	# A cowardly character would take the chance to kill the person
				add = 5
				has_trait = craven
			}
			modifier = {	# Character would rather kill the losers then keep them alive
				add = 25
				has_trait = wrathful
			}
			modifier = {	# Character would rather kill the losers then keep them alive
				add = 50
				has_trait = ambitious
			}
			modifier = {	# A forgiving character would never kill them
				add = -1000
				has_trait = forgiving
			}
			modifier = {	# Character would rather kill the losers then keep them alive
				add = 50
				has_trait = vengeful
			}
			modifier = {	# Character has just as much chance of killing as sparing them
				add = 10
				has_trait = arbitrary
			}
			modifier = {	# A paranoid character would be more likely to kill them (they may hold a grudge!)
				add = 10
				has_trait = paranoid
			}
			modifier = {	#A trusting character would be less likely to kill them
				add = -20
				has_trait = trusting
			}
			modifier = {	# A compassionate character would never kill his competitor
				add = 100
				has_trait = compassionate
			}
			modifier = {	# A sadistic character would always kill his competitor
				add = 1000
				has_trait = sadistic
			}
			modifier = {	#  A callous character would almost always kill his competitor 
				add = 100
				has_trait = callous
			}
		}																											
	}
}

#lost a fight, killed!
sjalvolki_succession.0010 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0010.t
	desc = sjalvolki_succession.0010.desc
	
	left_portrait = {
		character = root
		animation = beg
	}
	
	right_portrait = {
		character = var:partner
		animation = rage
	}
	
	option = {
		name = sjalvolki_succession.0010.a
		death = {
			killer = var:partner
			death_reason = death_duel
		}
	}
}
#prisoners can't fight!
sjalvolki_succession.0011 = {
	type = character_event
	theme = dungeon
	title = sjalvolki_succession.0011.t
	desc = sjalvolki_succession.0011.desc
	
	left_portrait = {
		character = root
		animation = prison_dungeon
	}
	
	
	option = {
		name = sjalvolki_succession.0011.a
	}
}
# Sending victory event to whoever won
sjalvolki_succession.0012 = {
	hidden = yes
	
	immediate = {
		if = {
			limit = {
				OR = {
					scope:sc_victor = root
					NOT = { has_variable = partner }
				}
			}
			trigger_event = sjalvolki_succession.0009
		}
		else = {
			var:partner = {
				trigger_event = sjalvolki_succession.0009
			}
		}
	}
}


#alerting all within contention the battle has begun, splitting contenders into four groups
sjalvolki_succession.0051 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0051.t
	desc = sjalvolki_succession.0051.desc
	

	left_portrait = {
		character = root
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = craven
					ai_boldness <= -100
				}
			}
			animation = personality_coward
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = brave
					ai_boldness >= -100
				}
			}
			animation = personality_bold
		}
		triggered_animation = {
			trigger = {
				OR = {
					has_trait = callous
					has_trait = sadistic
					NOR = {
						has_trait = brave
						has_trait = craven
						ai_boldness <= -100
						ai_boldness >= -100
					}
				}
			}
			animation = personality_callous
		}
		triggered_animation = {
			trigger = {
				always = yes
			}
			animation = worry
		}
	}
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	immediate = {
		scope:primary_scope = {
			save_scope_value_as = {
				name = counter
				value = 1
			}
			
			#seed the list with at least 8 random dudes, so that the system will never break under any circumstance
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			 	save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
			
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			 	save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
			
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			  	save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
			
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			 	 save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
			
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			 	save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
			
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			 	save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
			
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			  	save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
			
			create_character = {
				location = root.capital_province
				gender_female_chance = 50
				template_character = root
				random_traits = yes
				age = { 20 50 }
				
			 	 save_scope_as = temp
			}
			
			add_to_variable_list = {
				name = contesting_linked_titles
				target = scope:temp
			}
		}
		
		# Initiate all four rings as combat queues
		setup_queue = { 
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_first_ring
			SOURCE_LIST = contesting_linked_titles
			REMAINING_QUEUE_SIZE = 4
			QUEUE_EVENT = sjalvolki_succession.0004
		}
		setup_queue = { 
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_second_ring
			SOURCE_LIST = contesting_linked_titles
			REMAINING_QUEUE_SIZE = 3
			QUEUE_EVENT = sjalvolki_succession.0005
		}
		setup_queue = { 
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_third_ring
			SOURCE_LIST = contesting_linked_titles
			REMAINING_QUEUE_SIZE = 2
			QUEUE_EVENT = sjalvolki_succession.0006
		}
		setup_queue = { 
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_fourth_ring
			SOURCE_LIST = contesting_linked_titles
			REMAINING_QUEUE_SIZE = 1
			QUEUE_EVENT = sjalvolki_succession.0007
		}
		
		# Begin the recurring per-ring events
		random_living_character = {
			trigger_event = {
				id = sjalvolki_succession.0101
				days = 2
			}
			trigger_event = {
				id = sjalvolki_succession.0201
				days = 2
			}
			trigger_event = {
				id = sjalvolki_succession.0301
				days = 2
			}
			trigger_event = {
				id = sjalvolki_succession.0401
				days = 2
			}
		}
		
		scope:primary_scope = {
			# We immediately put this on, just in case, so the fifth ring never prematurely executes
			set_variable = {
				name = first_ring_combat_lock
				days = 3
			}
		}
		
		trigger_event = {
			 id = sjalvolki_succession.0501
			 days = 1
		}
	}
	
	option = {
		trait = cynical
		trait = zealous
		name = {
			trigger = { has_trait = cynical }
			text = sjalvolki_succession.0051.a.cynical
		}
		name = {
			trigger = { has_trait = zealous }
			text = sjalvolki_succession.0051.a.zealous
		}
		name = {
			trigger = {
				NOR = {
					has_trait = cynical
					has_trait = zealous
				}
			}
			text = sjalvolki_succession.0051.a
		}
		if = {
			limit = { has_trait = cynical }
			custom_tooltip = scoff_at_speech_tt
			add_prestige = minor_prestige_gain
			add_piety = minor_piety_loss
		}
		else_if = {
			limit = { has_trait = zealous }
			add_piety = minor_piety_gain
		}
	}
}

##################################################
# First Ring
# by mpjama and Hapchazzard
# 0101 - 0110
##################################################

sjalvolki_succession.0101 = {
	type = empty
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			# A lock is put in place. The fifth ring can only begin once all four locks are lifted, implying that combat has ended in all rings prior to the fifth
			set_variable = {
				name = first_ring_combat_lock
				days = 2
			}
		}
		execute_queue = {
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_first_ring
			QUEUE_CRITERION = valid_for_sjalvolki_succession_trigger
			EMPTY_LIST_FALLBACK_EVENT = sjalvolki_succession.0105
			LAST_QUEUE_PARTICIPANT_EVENT = sjalvolki_succession.0103
			QUEUE_DUEL_EVENT = sjalvolki_succession.0102
			QUEUE_CONTINUE_EVENT = sjalvolki_succession.0101
		}
	}
}

# Alerting the player party of the duel, and determining the outcome
sjalvolki_succession.0102 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0102.t
	desc = sjalvolki_succession.0102.desc
	
	override_background = {
		event_background = fp1_tribal_temple
	}

	left_portrait = {
		character = this
		animation = rage
	}
	
	right_portrait = {
		character = var:partner
		animation = rage
	}
	
	immediate = {
		var:partner = {
			save_scope_as = duel_partner
		}
	}
	
	option = {
		name = sjalvolki_succession.0102.a

		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:duel_partner
			FATALITY = no
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = sjalvolki_succession.0012
			INVALIDATION_EVENT = sjalvolki_succession.0012
		}
	}
}

# Alerting the Champion that they won
sjalvolki_succession.0103 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0103.t
	desc = sjalvolki_succession.0103.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}

	left_portrait = {
		character = this
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0103.a
		
		scope:primary_scope = {
			add_to_variable_list = {
				name = contesting_linked_titles_fifth_ring
				target = prev
			}
			every_in_list = {
				limit = {
					NOT = {
						this = root
					}
				}
				variable = contesting_linked_titles
				save_scope_as = champion_of_the_first_ring
				trigger_event = {
					id = sjalvolki_succession.0104
				}
			}
		}
		
		add_character_modifier = {
			modifier = champion_of_the_first_ring
			years = 10
		}
	}
}

# Alerting all other contestants of the winner
sjalvolki_succession.0104 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0104.t
	desc = sjalvolki_succession.0104.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = scope:champion_of_the_first_ring
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0104.a
	}
}

sjalvolki_succession.0105 = {
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			remove_variable = first_ring_combat_lock
		}
	}
}

##################################################
# Second Ring
# by mpjama and Hapchazzard
# 0201 - 0210
##################################################

sjalvolki_succession.0201 = {
	type = empty
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			# A lock is put in place. The fifth ring can only begin once all four locks are lifted, implying that combat has ended in all rings prior to the fifth
			set_variable = {
				name = second_ring_combat_lock
				days = 2
			}
		}
		execute_queue = {
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_second_ring
			QUEUE_CRITERION = valid_for_sjalvolki_succession_trigger
			EMPTY_LIST_FALLBACK_EVENT = sjalvolki_succession.0205
			LAST_QUEUE_PARTICIPANT_EVENT = sjalvolki_succession.0203
			QUEUE_DUEL_EVENT = sjalvolki_succession.0202
			QUEUE_CONTINUE_EVENT = sjalvolki_succession.0201
		}
	}
}

# Alerting the player party of the duel, and determining the outcome
sjalvolki_succession.0202 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0202.t
	desc = sjalvolki_succession.0202.desc
	
	override_background = {
		event_background = fp1_tribal_temple
	}

	left_portrait = {
		character = this
		animation = rage
	}
	
	right_portrait = {
		character = var:partner
		animation = rage
	}
	
	immediate = {
		var:partner = {
			save_scope_as = duel_partner
		}
	}
	
	option = {
		name = sjalvolki_succession.0202.a

		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:duel_partner
			FATALITY = no
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = sjalvolki_succession.0012
			INVALIDATION_EVENT = sjalvolki_succession.0012
		}
	}
}

# Alerting the Champion that they won
sjalvolki_succession.0203 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0203.t
	desc = sjalvolki_succession.0203.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}

	left_portrait = {
		character = this
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0203.a
		
		scope:primary_scope = {
			add_to_variable_list = {
				name = contesting_linked_titles_fifth_ring
				target = prev
			}
			every_in_list = {
				limit = {
					NOT = {
						this = root
					}
				}
				variable = contesting_linked_titles
				save_scope_as = champion_of_the_second_ring
				trigger_event = {
					id = sjalvolki_succession.0204
				}
			}
		}
		
		add_character_modifier = {
			modifier = champion_of_the_second_ring
			years = 10
		}
	}
}

# Alerting all other contestants of the winner
sjalvolki_succession.0204 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0204.t
	desc = sjalvolki_succession.0204.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = scope:champion_of_the_second_ring
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0204.a
	}
}

sjalvolki_succession.0205 = {
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			remove_variable = second_ring_combat_lock
		}
	}
}

##################################################
# Third Ring
# by mpjama and Hapchazzard
# 0301 - 0310
##################################################

sjalvolki_succession.0301 = {
	type = empty
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			# A lock is put in place. The fifth ring can only begin once all four locks are lifted, implying that combat has ended in all rings prior to the fifth
			set_variable = {
				name = third_ring_combat_lock
				days = 2
			}
		}
		execute_queue = {
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_third_ring
			QUEUE_CRITERION = valid_for_sjalvolki_succession_trigger
			EMPTY_LIST_FALLBACK_EVENT = sjalvolki_succession.0305
			LAST_QUEUE_PARTICIPANT_EVENT = sjalvolki_succession.0303
			QUEUE_DUEL_EVENT = sjalvolki_succession.0302
			QUEUE_CONTINUE_EVENT = sjalvolki_succession.0301
		}
	}
}

# Alerting the player party of the duel, and determining the outcome
sjalvolki_succession.0302 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0302.t
	desc = sjalvolki_succession.0302.desc
	
	override_background = {
		event_background = fp1_tribal_temple
	}

	left_portrait = {
		character = this
		animation = rage
	}
	
	right_portrait = {
		character = var:partner
		animation = rage
	}
	
	immediate = {
		var:partner = {
			save_scope_as = duel_partner
		}
	}
	
	option = {
		name = sjalvolki_succession.0302.a

		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:duel_partner
			FATALITY = no
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = sjalvolki_succession.0012
			INVALIDATION_EVENT = sjalvolki_succession.0012
		}
	}
}

# Alerting the Champion that they won
sjalvolki_succession.0303 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0303.t
	desc = sjalvolki_succession.0303.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}

	left_portrait = {
		character = this
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0303.a
		
		scope:primary_scope = {
			add_to_variable_list = {
				name = contesting_linked_titles_fifth_ring
				target = root
			}
			every_in_list = {
				limit = {
					NOT = {
						this = root
					}
				}
				variable = contesting_linked_titles
				save_scope_as = champion_of_the_third_ring
				trigger_event = {
					id = sjalvolki_succession.0304
				}
			}
		}
		
		add_character_modifier = {
			modifier = champion_of_the_third_ring
			years = 10
		}
	}
}

# Alerting all other contestants of the winner
sjalvolki_succession.0304 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0304.t
	desc = sjalvolki_succession.0304.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = scope:champion_of_the_third_ring
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0304.a
	}
}

sjalvolki_succession.0305 = {
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			remove_variable = third_ring_combat_lock
		}
	}
}

##################################################
# Fourth Ring
# by mpjama and Hapchazzard
# 0401 - 0410
##################################################

sjalvolki_succession.0401 = {
	type = empty
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			# A lock is put in place. The fifth ring can only begin once all four locks are lifted, implying that combat has ended in all rings prior to the fifth
			set_variable = {
				name = fourth_ring_combat_lock
				days = 2
			}
		}
		execute_queue = {
			QUEUE_SCOPE = scope:primary_scope
			QUEUE_NAME = contesting_linked_titles_fourth_ring
			QUEUE_CRITERION = valid_for_sjalvolki_succession_trigger
			EMPTY_LIST_FALLBACK_EVENT = sjalvolki_succession.0405
			LAST_QUEUE_PARTICIPANT_EVENT = sjalvolki_succession.0403
			QUEUE_DUEL_EVENT = sjalvolki_succession.0402
			QUEUE_CONTINUE_EVENT = sjalvolki_succession.0401
		}
	}
}

# Alerting the player party of the duel, and determining the outcome
sjalvolki_succession.0402 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0402.t
	desc = sjalvolki_succession.0402.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}

	left_portrait = {
		character = this
		animation = rage
	}
	
	right_portrait = {
		character = var:partner
		animation = rage
	}
	
	immediate = {
		var:partner = {
			save_scope_as = duel_partner
		}
	}
	
	option = {
		name = sjalvolki_succession.0402.a

		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:duel_partner
			FATALITY = no
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = sjalvolki_succession.0012
			INVALIDATION_EVENT = sjalvolki_succession.0012
		}
	}
}

# Alerting the Champion that they won
sjalvolki_succession.0403 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0403.t
	desc = sjalvolki_succession.0403.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}

	left_portrait = {
		character = this
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0403.a
		
		scope:primary_scope = {
			add_to_variable_list = {
				name = contesting_linked_titles_fifth_ring
				target = root
			}
			every_in_list = {
				limit = {
					NOT = {
						this = root
					}
				}
				variable = contesting_linked_titles
				save_scope_as = champion_of_the_fourth_ring
				trigger_event = {
					id = sjalvolki_succession.0304
				}
			}
		}
		
		add_character_modifier = {
			modifier = champion_of_the_fourth_ring
			years = 10
		}
	}
}

# Alerting all other contestants of the winner
sjalvolki_succession.0404 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0404.t
	desc = sjalvolki_succession.0404.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = scope:champion_of_the_fourth_ring
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0404.a
	}
}

sjalvolki_succession.0405 = {
	hidden = yes
	
	immediate = {
		scope:primary_scope = {
			remove_variable = fourth_ring_combat_lock
		}
	}
}

##################################################
# Fifth Ring
# by mpjama and Hapchazzard
# 0501 - 0510
##################################################

sjalvolki_succession.0501 = {
	hidden = yes
	
	immediate = {
		if = {
			limit = {
				scope:primary_scope = {
					NOR = {
						has_variable = first_ring_combat_lock
						has_variable = second_ring_combat_lock
						has_variable = third_ring_combat_lock
						has_variable = fourth_ring_combat_lock
					}
				}
			}
			execute_queue = {
				QUEUE_SCOPE = scope:primary_scope
				QUEUE_NAME = contesting_linked_titles_fifth_ring
				QUEUE_CRITERION = valid_for_sjalvolki_succession_trigger
				EMPTY_LIST_FALLBACK_EVENT = sjalvolki_succession.0505
				LAST_QUEUE_PARTICIPANT_EVENT = sjalvolki_succession.0503
				QUEUE_DUEL_EVENT = sjalvolki_succession.0502
				QUEUE_CONTINUE_EVENT = sjalvolki_succession.0501
			}
		}
		else = {
			random_living_character = {
				trigger_event = {
					id = sjalvolki_succession.0501
					days = 1
				}
			}
		}
	}
}

# Alerting the player party of the duel, and determining the outcome
sjalvolki_succession.0502 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0502.t
	desc = sjalvolki_succession.0502.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}

	left_portrait = {
		character = this
		animation = rage
	}
	
	right_portrait = {
		character = var:partner
		animation = rage
	}
	
	immediate = {
		var:partner = {
			save_scope_as = duel_partner
		}
	}
	
	option = {
		name = sjalvolki_succession.0502.a

		configure_start_single_combat_effect = {
			SC_INITIATOR = root
			SC_ATTACKER = root
			SC_DEFENDER = scope:duel_partner
			FATALITY = no
			FIXED = no
			LOCALE = terrain_scope
			OUTPUT_EVENT = sjalvolki_succession.0012
			INVALIDATION_EVENT = sjalvolki_succession.0012
		}
	}
}

#Alerting the Champion he won
sjalvolki_succession.0503 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0503.t
	desc = sjalvolki_succession.0503.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}

	left_portrait = {
		character = this
		animation = war_over_win
	}
	
	immediate = {
		if = {
			limit = { has_character_flag = temporary_holder }
			remove_character_flag = temporary_holder
		}
		save_scope_as = champion_of_the_fifth_ring
	}
	
	option = {
		name = sjalvolki_succession.0503.a
		
		scope:primary_scope = {
			every_in_list = {
				variable = contesting_linked_titles
				limit = {
					NOR = {
						this = root
						this = scope:primary_scope.holder
					}
				}
				trigger_event = {
					id = sjalvolki_succession.0504
				}
			}
		}
		
		remove_character_modifier = champion_of_the_first_ring
		remove_character_modifier = champion_of_the_second_ring
		remove_character_modifier = champion_of_the_third_ring
		remove_character_modifier = champion_of_the_fourth_ring
		
		
		add_character_modifier = {
			modifier = champion_of_the_fifth_ring
			years = 10
		}
		scope:primary_scope = {
			if = {
				limit = {
					holder = {
						NOT = { 
							this = root
						}
					}
				}
				holder = {
					trigger_event = {
						id = sjalvolki_succession.0506
						days = 1
					}
				}
			}
		}
	}
}
#alerting all contestants who won!
sjalvolki_succession.0504 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0504.t
	desc = sjalvolki_succession.0504.desc
	
	override_background = {
		event_background = fp1_runestone_circle
	}
	
	left_portrait = {
		character = scope:champion_of_the_fifth_ring
		animation = war_over_win
	}
	
	option = {
		name = sjalvolki_succession.0504.a
	}
}

sjalvolki_succession.0505 = {
	hidden = yes
	
	immediate = {
		# Intentionally empty, only exists so we don't get errors
	}
}

# Alert the temporary title holder about the winner
sjalvolki_succession.0506 = {
	type = character_event
	theme = battle
	title = sjalvolki_succession.0506.t
	desc = {
		desc = sjalvolki_succession.0506.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					OR = {
						has_trait = vengeful
						has_trait = sadistic
						has_trait = callous
						has_trait = ambitious
						has_relation_rival = scope:champion_of_the_fifth_ring
						has_relation_nemesis = scope:champion_of_the_fifth_ring
					}
					NOR = {
						has_relation_friend = scope:champion_of_the_fifth_ring
						has_relation_best_friend = scope:champion_of_the_fifth_ring
						has_relation_soulmate = scope:champion_of_the_fifth_ring
						has_relation_lover = scope:champion_of_the_fifth_ring
					}
				}
				desc = sjalvolki_succession.0506.desc.bitter_loser
			}
		}
	}
	
	override_background = {
		trigger = { has_government = tribal_government }
		event_background = fp1_throneroom_tribal
	}
	override_background = {
		trigger = { NOT = { has_government = tribal_government } }
		event_background = fp1_throneroom_nontribal
	}
	
	left_portrait = {
		character = root
		animation = personality_rational
	}
	
	right_portrait = {
		character = scope:champion_of_the_fifth_ring
		animation = war_over_win
	}
	
	immediate = {
		scope:primary_scope = {
			every_in_list = {
				variable = linked_titles
				add_to_list = titles_at_stake
			}
		}
	}
	
	option = {
		name = {
			trigger = {
				OR = {
					has_trait = vengeful
					has_trait = sadistic
					has_trait = callous
					has_trait = ambitious
					has_relation_rival = scope:champion_of_the_fifth_ring
					has_relation_nemesis = scope:champion_of_the_fifth_ring
				}
				NOR = {
					has_relation_friend = scope:champion_of_the_fifth_ring
					has_relation_best_friend = scope:champion_of_the_fifth_ring
					has_relation_soulmate = scope:champion_of_the_fifth_ring
					has_relation_lover = scope:champion_of_the_fifth_ring
				}
			}
			text = sjalvolki_succession.0506.a.bitter_loser
		}
		name = {
			trigger = {
				NOT = {
					OR = {
						has_trait = vengeful
						has_trait = sadistic
						has_trait = callous
						has_trait = ambitious
						has_relation_rival = scope:champion_of_the_fifth_ring
						has_relation_nemesis = scope:champion_of_the_fifth_ring
					}
					NOR = {
						has_relation_friend = scope:champion_of_the_fifth_ring
						has_relation_best_friend = scope:champion_of_the_fifth_ring
						has_relation_soulmate = scope:champion_of_the_fifth_ring
						has_relation_lover = scope:champion_of_the_fifth_ring
					}
				}
			}
			text = sjalvolki_succession.0506.a
		}		

		if = {
			limit = {
				trigger_if = {
					limit = { is_ai = no }
					dynasty = {
						any_dynasty_member = {
							this = scope:champion_of_the_fifth_ring
						}
					}
				}
				trigger_else = { always = no }
			}
			set_player_character = scope:champion_of_the_fifth_ring
		}
		
		create_title_and_vassal_change = {
			type = conquest_claim
			save_scope_as = change
			add_claim_on_loss = no
		}
		
		setup_claim_cb = {
			titles = titles_at_stake
			attacker = scope:champion_of_the_fifth_ring
			defender = scope:primary_scope.holder
			claimant = scope:champion_of_the_fifth_ring
			change = scope:change
			civil_war = yes
		}
	
		resolve_title_and_vassal_change = scope:change
		
		succession_cleanup = yes
		scope:primary_scope = {
			scope:primary_scope = {
				clear_variable_list = contesting_linked_titles_first_ring
				clear_variable_list = contesting_linked_titles_second_ring
				clear_variable_list = contesting_linked_titles_third_ring
				clear_variable_list = contesting_linked_titles_fourth_ring
				clear_variable_list = contesting_linked_titles_fifth_ring
			}
		}
	}
}